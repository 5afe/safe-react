language: node_js
node_js:
  - "8"
os:
  - linux
before_script:
  - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
  - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
  - sudo apt-get update && sudo apt-get install yarn
  - yarn global add truffle
  - yarn global add surge
  - git clone https://github.com/gnosis/gnosis-safe-contracts.git
  - cd gnosis-safe-contracts
  - truffle compile && cd ..
after_success:
  - yarn build-storybook
  - yarn build
  - |
    if [ ${TRAVIS_BRANCH} = "master" ]; then
      export NODE_ENV=production;
    else
      export NODE_ENV=development;
    fi
  - chmod ugo+x ./config/deploy/deploy.sh
  - ./config/deploy/deploy.sh
